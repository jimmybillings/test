<form 
  layout="column" 
  [formGroup]="form" 
  novalidate 
  class="md-inline-form"
  autocomplete="{{autocomplete}}"
  (ngSubmit)="onSubmit()">

    <div *ngFor="let field of items; let i=index">
      <md-input
        *ngIf="isRequiredField(field) && (field.type == 'text' || field.type == 'password' || field.type == 'email' || field.type == 'date')"
        class="md-block"
        [ngClass]="{'show-errors': (!form.controls[field.name].valid && form.controls[field.name].pristine && submitAttempt) || (!form.controls[field.name].valid && !form.controls[field.name].pristine && submitAttempt) || (!form.controls[field.name].valid && !form.controls[field.name].pristine && !submitAttempt)}"
        placeholder="{{field.label | translate}}"
        type="{{field.type}}"
        formControlName="{{field.name}}"
        id="{{field.name}}"
        [required]="isRequiredField(field)"
      >

        <!--secondary field explainations (hints) there are two places for these below the field at the start and end-->
        <md-hint *ngIf="field.hintTextStart && !form.controls[field.name].errors" align="start">
          {{ field.hintTextEnd | translate }}
        </md-hint>
        <md-hint *ngIf="field.hintTextEnd && !form.controls[field.name].errors" align="end">
          {{ field.hintTextEnd | translate }}
        </md-hint>

        <md-hint *ngIf="!form.controls[field.name].valid"
          [hidden]="form.controls[field.name].valid || form.controls[field.name].pristine && !submitAttempt" 
          align="start" 
          class="error">
            <span *ngIf="form.controls[field.name].hasError('required')">
              {{ 'ERRORS.MISSING_REQUIRED_FIELD' | translate:{fieldName:field.label | translate} }}
            </span>
            <span *ngIf="form.controls[field.name].hasError('minlength')">
              {{ 'ERRORS.MIN_LENGTH_REQUIRED' | translate:{charLength:form.controls[field.name]._errors.minlength.requiredLength} }}
            </span>
            <span *ngIf="form.controls[field.name].hasError('pattern') && !form.controls[field.name].hasError('minlength')">
              {{ 'ERRORS.VALID_EMAIL_REQUIRED' | translate }}
            </span>
            <span *ngIf="form.controls[field.name].hasError('startsWithNumber')">
              {{ 'ERRORS.NAME_ALREADY_TAKEN' | translate:{fieldName:field.label | translate} }}
            </span>
            <span *ngIf="form.controls[field.name].hasError('collectionNameTaken')">
              Name is already taken
            </span>
            <span *ngIf="form.controls[field.name].hasError('serverError')">
              {{ 'ERRORS.'+form.controls[field.name].errors.serverError | translate }}
            </span>
              
        </md-hint>
      </md-input>
      
      <md-input
        *ngIf="!isRequiredField(field) && (field.type == 'text' || field.type == 'password' || field.type == 'email' || field.type == 'date')"
        class="md-block"
        [ngClass]="{'show-errors': (!form.controls[field.name].valid && form.controls[field.name].pristine && submitAttempt) || (!form.controls[field.name].valid && !form.controls[field.name].pristine && submitAttempt) || (!form.controls[field.name].valid && !form.controls[field.name].pristine && !submitAttempt)}"
        placeholder="{{field.label | translate}}"
        type="{{field.type}}"
        formControlName="{{field.name}}"
        id="{{field.name}}"
      >
        <!--secondary field explainations (hints) there are two places for these below the field at the start and end-->
        <md-hint *ngIf="field.hintTextStart" align="start">
          {{ field.hintTextStart | translate }}
        </md-hint>
        <md-hint *ngIf="field.hintTextEnd" align="end">
          {{ field.hintTextEnd | translate }}
        </md-hint>
      </md-input>

      <div *ngIf="field.type == 'select'">
        <md-input-group class="md-group">
          <select formControlName="{{field.name}}">
            <option *ngFor="let option of parseOptions(field.options)">{{option}}</option>
          </select>
        </md-input-group>
      </div>
      <md-radio-group *ngIf="field.type == 'radio'" layout="row" formControlName="{{field.name}}">
        <md-radio-button
          style="margin-right: 1rem;"
          *ngFor="let option of parseOptions(field.options)"
          [checked]="parseOptions(field.options)[0]==option"
          [value]="option"
          class="md-primary"
          (click)="radioSelect(field.name, option)">
            {{option}}
        </md-radio-button>
      </md-radio-group>
    </div>
    
    <div class="indicate-required" *ngIf="showRequiredLegend">
      <span>{{ 'ERRORS.INDICATES_REQUIRED_FIELD' | translate }}</span>
    </div>
    
    <md-card-actions layout="row" layout-align="center center">
      <button md-raised-button type="submit" color="primary" class="conversion">{{submitLabel | translate}}</button>
    </md-card-actions>
  <!--</md-content>-->
</form>
